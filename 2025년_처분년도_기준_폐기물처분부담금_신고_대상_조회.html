<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>2025년 처분년도 기준 폐기물처분부담금 신고 대상 조회</title>
  <style>
    :root {
      --brand-bg1: #e8f5f0;
      --brand-bg2: #eef6ff;
      --brand-primary: #0ea5a1;  /* teal-ish */
      --brand-deep: #0369a1;     /* blue-ish */
      --ink: #0f172a;
      --muted: #64748b;
      --card: #ffffff;
      --border: #e5e7eb;
      --ring: rgba(14,165,161,.35);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; color: var(--ink);
      background: radial-gradient(1200px 800px at 10% -10%, var(--brand-bg1), transparent 60%),
                  radial-gradient(1200px 800px at 110% 10%, var(--brand-bg2), transparent 60%),
                  #f8fafc;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
    }
    .container { max-width: 980px; margin: 0 auto; padding: 24px 16px 48px; }
    .hero {
      margin: 12px 0 20px; padding: 20px 20px;
      border-radius: 20px;
      background: linear-gradient(135deg, rgba(14,165,161,.08), rgba(3,105,161,.08));
      border: 1px solid var(--border);
      box-shadow: 0 2px 20px rgba(2, 132, 199, .06);
    }
    .hero h1 {
      margin: 0 0 8px; font-size: 22px; line-height: 1.25;
      letter-spacing: -0.015em;
    }
    .hero p { margin: 0; color: var(--muted); font-size: 13px; }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 1px 2px rgba(0,0,0,.04);
    }
    .search-row {
      display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center;
    }
    .input-wrap { position: relative; }
    .input-wrap svg {
      position: absolute; left: 12px; top: 50%; transform: translateY(-50%);
      width: 18px; height: 18px; opacity: .55;
    }
    input[type="text"] {
      width: 100%; padding: 12px 12px 12px 38px; border-radius: 12px;
      border: 1px solid var(--border); outline: none; font-size: 15px;
    }
    input[type="text"]:focus { box-shadow: 0 0 0 4px var(--ring); border-color: var(--brand-primary); }
    .btn {
      padding: 12px 16px; border-radius: 12px; border: 1px solid var(--border);
      background: #fff; cursor: pointer; font-weight: 600;
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-deep));
      border-color: transparent; color: #fff;
      box-shadow: 0 6px 20px rgba(3,105,161,.2);
    }
    .btn:active { transform: translateY(1px); }
    .helper { margin-top: 6px; color: var(--muted); font-size: 12px; }
    .toolbar { display: flex; gap: 8px; align-items: center; justify-content: flex-end; flex-wrap: wrap; }
    .status { font-size: 12px; color: var(--muted); }
    table { border-collapse: collapse; width: 100%; }
    thead th {
      position: sticky; top: 0; background: #f9fafb; z-index: 1;
      text-align: left; padding: 12px; border-bottom: 1px solid var(--border);
      font-size: 13px; color: #0f172a; letter-spacing: .01em;
    }
    tbody td { padding: 12px; border-bottom: 1px solid #f1f5f9; font-size: 14px; }
    tbody tr:hover { background: #fafafa; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', monospace; }
    .pill {
      display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 12px;
      background: #f1f5f9; border: 1px solid var(--border); color: #0f172a;
    }
    .footer { text-align: center; color: var(--muted); font-size: 12px; margin-top: 18px; }
    /* Toast */
    .toast { position: fixed; left: 50%; bottom: 24px; transform: translateX(-50%) translateY(20px);
      background: rgba(17,24,39,.98); color: #fff; padding: 10px 14px; border-radius: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,.25); opacity: 0; transition: all .25s ease; pointer-events: none; font-size: 13px; }
    .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
  </style>
</head>
<body>
  <div class="container">
    <div class="hero">
      <h1>2025년 처분년도 기준 폐기물처분부담금 신고 대상 조회</h1>
      <p>사업자번호를 입력하면 해당 사업자에게 매칭된 올바로ID와 공사명(사업장명)을 확인할 수 있습니다. 하이픈 유무는 관계 없습니다.</p>
    </div>

    <div class="card" style="margin-bottom: 12px;">
      <div class="search-row">
        <div class="input-wrap">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.3-4.3m1.8-5.2a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/></svg>
          <input id="brnInput" type="text" placeholder="사업자번호 입력 (예: 123-45-67890 또는 1234567890)" aria-label="사업자번호 입력" />
        </div>
        <button id="btnSearch" class="btn btn-primary">조회</button>
      </div>
      <div class="helper">※ 예: 123-45-67890 (하이픈 유무 무관)</div>
    </div>

    <div class="card">
      <div class="toolbar" style="margin-bottom: 6px;">
        <span id="status" class="status">사업자번호를 입력해 조회하세요.</span>
        <button id="btnExport" class="btn">결과 CSV 다운로드</button>
      </div>
      <div style="overflow-x:auto; border-radius: 10px;">
        <table>
          <thead>
            <tr>
              <th style="width: 24%;">사업자번호</th>
              <th style="width: 22%;">올바로ID</th>
              <th>공사명(사업장명)</th>
            </tr>
          </thead>
          <tbody id="resultBody">
            <tr><td colspan="3" style="text-align:center; color:#94a3b8; padding: 18px;">조회 결과가 여기에 표시됩니다.</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="footer">© 2025 한국환경공단 광주전남제주환경본부 제도운영부 • 내부 조회용</div>
  </div>

  <div id="toast" class="toast">복사되었습니다</div>

  <script>
    const EMBEDDED = [{"brn": "408-81-87078", "olbaroId": "030-25", "projectName": "(주)강산개발-2025년 소나무재선충병 예방을 위한 고사목 제거사업", "brnNorm": "4088187078"}, {"brn": "612-85-01828", "olbaroId": "KPS3005-3", "projectName": "25년 광주전남 정기점검보수공사(기계,전기)", "brnNorm": "6128501828"}, {"brn": "135-86-32331", "olbaroId": "bbg26", "projectName": "광주사업장 D동 2층 모터시작실 조성 건축공사", "brnNorm": "1358632331"}, {"brn": "411-83-00391", "olbaroId": "cey3331", "projectName": "2025년 영산강 하구 적치폐기물 처리 용역(2차)", "brnNorm": "4118300391"}, {"brn": "830-88-01863", "olbaroId": "chamsamc3", "projectName": "탱크청소 지정폐기물 액·고상 운반 및 처리 광주광역시 북구 임동 100-1", "brnNorm": "8308801863"}, {"brn": "407-88-02060", "olbaroId": "chb6496-7", "projectName": "영광전자고 관사 보수 및 급식실 샌드위치판넬 해소공사", "brnNorm": "4078802060"}, {"brn": "219-81-12623", "olbaroId": "daekun2025", "projectName": "광양항 율촌 융복합물류단지 조성공사중 연약지반 처리공사", "brnNorm": "2198112623"}, {"brn": "226-81-31929", "olbaroId": "dd4034", "projectName": "성전중 외 1교 교사동 창호교체공사", "brnNorm": "2268131929"}, {"brn": "412-83-02811", "olbaroId": "dhkdrhrrlch", "projectName": "*나주시청(농업정책과)-왕곡면 기초생활거점조성사업 폐기물 처리용역", "brnNorm": "4128302811"}, {"brn": "408-83-00696", "olbaroId": "dhrrhkgidry", "projectName": "*곡성군청-옥과향교~옥과교회간 도시계획도로 개설공사 폐기물 처리 운반 용역", "brnNorm": "4088300696"}, {"brn": "411-83-01162", "olbaroId": "dkqgoehdrkdekd1", "projectName": "압해동초 다목적강당 증축공사 폐기물처리용역", "brnNorm": "4118301162"}, {"brn": "411-83-03103", "olbaroId": "dkswjs2025-051", "projectName": "무안군청-구제역 방역차량 전도에 따른 지정 폐기물 처리용역 시행", "brnNorm": "4118303103"}, {"brn": "416-81-19926", "olbaroId": "dm157", "projectName": "(유)대명산업 사업장내 지정폐기물 처리 용역", "brnNorm": "4168119926"}, {"brn": "409-83-01679", "olbaroId": "dnjftks2503", "projectName": "월산면사무소-2025년 시설하우스 주변환경 정비사업", "brnNorm": "4098301679"}, {"brn": "415-83-00016", "olbaroId": "dudshdqntksanf12", "projectName": "영농부산물 안전처리 지원사업 폐기물 소각처리 용역", "brnNorm": "4158300016"}, {"brn": "409-83-01723", "olbaroId": "dydaus2503", "projectName": "용면사무소-2025년 시설하우스 주변환경 정비사업", "brnNorm": "4098301723"}, {"brn": "416-81-82716", "olbaroId": "eden25-1", "projectName": "사랑아파트 공동구 고층부 난방배관 부분 교체 긴급공사", "brnNorm": "4168182716"}, {"brn": "416-81-82716", "olbaroId": "eden25-3", "projectName": "사랑아파트 공동구 난방배관 부분교체-긴급공사", "brnNorm": "4168182716"}, {"brn": "409-86-13287", "olbaroId": "ehdqhr0214", "projectName": "화순동복중 교사 천장 보수공사", "brnNorm": "4098613287"}, {"brn": "409-83-02514", "olbaroId": "ehfhghksrud2025", "projectName": "도로환경 개선에 따른 폐기물 처리용역(2025)", "brnNorm": "4098302514"}, {"brn": "412-83-01898", "olbaroId": "ehtlrPghlr2024", "projectName": "함평군 농협중앙회 ~ 국토정보공사간(잔여구간) 가연성폐기물 처리용역", "brnNorm": "4128301898"}, {"brn": "410-86-31325", "olbaroId": "ek10162501", "projectName": "이케이이앤지(주)-계곡초 외 1교(옥천초) 드라이비트 제거 및 기타보수 공사", "brnNorm": "4108631325"}, {"brn": "409-83-01591", "olbaroId": "ekadid202502", "projectName": "월산초 외 1교 본관동 내진보강 시설공사 가연성폐기물 처리용역", "brnNorm": "4098301591"}, {"brn": "409-83-01515", "olbaroId": "ekadid25-76", "projectName": "담양군청-전라남도 담양군 관내 일원", "brnNorm": "4098301515"}, {"brn": "409-83-01515", "olbaroId": "ekadidtngo", "projectName": "*담양군청(환경과)-담양군 수해폐기물처리용역 2차(2권역)", "brnNorm": "4098301515"}, {"brn": "411-81-19431", "olbaroId": "g1100220", "projectName": "몽탄초 급식실 및 관사 드라이비트 해소공사 옥토건설(주)", "brnNorm": "4118119431"}, {"brn": "409-82-12640", "olbaroId": "gidp2024", "projectName": "분청사기 전시실 및 가마터 보호각 보수공사", "brnNorm": "4098212640"}, {"brn": "835-81-00614", "olbaroId": "haedam78571", "projectName": "버버리 신세계 광주 인테리어공사", "brnNorm": "8358100614"}, {"brn": "412-81-20270", "olbaroId": "hb-dkswhkch", "projectName": "안좌초 본관동 내진보강공사", "brnNorm": "4128120270"}, {"brn": "409-81-78188", "olbaroId": "hk250119", "projectName": "고려고등학교 고교학점제 학교공간조성 건축공사", "brnNorm": "4098178188"}, {"brn": "412-81-40562", "olbaroId": "hm2025-22", "projectName": "나산초 급식실 보수공사", "brnNorm": "4128140562"}, {"brn": "807-81-02131", "olbaroId": "hsb7958-1", "projectName": "증도~지도간 도로확포장공사 폐기물처리용역", "brnNorm": "8078102131"}, {"brn": "215-81-60458", "olbaroId": "jace8877pts", "projectName": "한빛2발전소 30년차 포스트텐셔닝계통 가동중검사 ((주)제이스코리아)", "brnNorm": "2158160458"}, {"brn": "412-83-05652", "olbaroId": "jdaun2", "projectName": "국립나주박물관 디지털 복합문화관 건립공사 건설폐기물 처리", "brnNorm": "4128305652"}, {"brn": "409-83-02794", "olbaroId": "jindocho2024", "projectName": "진도초 그린스마트스쿨 개축공사 가연성 폐기물 처리용역", "brnNorm": "4098302794"}, {"brn": "833-86-00501", "olbaroId": "jk20241104", "projectName": "봉황농공단지길 134-10, 남도에너지(주) 나주공장", "brnNorm": "8338600501"}, {"brn": "691-88-01180", "olbaroId": "jw1903-37", "projectName": "꼬두메 복합커뮤니티센터 조성사업 건축공사", "brnNorm": "6918801180"}, {"brn": "202-86-01934", "olbaroId": "jyj6024332-6", "projectName": "예술의전당 노후 시설물 개선 건축공사", "brnNorm": "2028601934"}, {"brn": "101-81-95610", "olbaroId": "khmgha", "projectName": "금호타이어(주)곡성공장", "brnNorm": "1018195610"}, {"brn": "409-86-18749", "olbaroId": "kn250509", "projectName": "(주)경남건설 폐유성페인트 처리", "brnNorm": "4098618749"}, {"brn": "828-87-03124", "olbaroId": "konggan2027", "projectName": "수완하나중 AI팩토리 (미래교실)구축공사", "brnNorm": "8288703124"}, {"brn": "416-81-52167", "olbaroId": "ksg5818", "projectName": "보성군 농촌 신활력플러스사업 키위 거점센터 부지 정비사업", "brnNorm": "4168152167"}, {"brn": "416-81-16782", "olbaroId": "lhw151", "projectName": "(광양)남측 원료-B 야드지역 환통법 대응 세륜시설 개조_토건(공사)", "brnNorm": "4168116782"}, {"brn": "411-83-00692", "olbaroId": "m20250205", "projectName": "목포석현초 놀이시설 개선공사 건설폐기물(소각) 처리용역-전라남도목포교육청", "brnNorm": "4118300692"}, {"brn": "416-81-13617", "olbaroId": "mb1136", "projectName": "(광양)2소결 Room EP Main Duct 좌굴로 인한 기능상실 복원_개산계약(돌발프로세스)", "brnNorm": "4168113617"}, {"brn": "416-81-13617", "olbaroId": "mb1144", "projectName": "(용역) 2025년 광양 산소공장 9Plant 불순물 흡착기 10Plant 이설 작업", "brnNorm": "4168113617"}, {"brn": "416-81-13617", "olbaroId": "mb1146", "projectName": "(광양)3냉연 Utility 소석회 Silo 개체 및 용해 Pit Mist 살수 자동화", "brnNorm": "4168113617"}, {"brn": "411-83-00391", "olbaroId": "mokpo3331", "projectName": "2025년 영산강하구 적치폐기물 처리용역-목포시청", "brnNorm": "4118300391"}, {"brn": "306-82-00471", "olbaroId": "muan2024", "projectName": "무안군 지방상수도 현대화사업 관망정비공사 건설폐기물 처리용역", "brnNorm": "3068200471"}, {"brn": "416-83-04844", "olbaroId": "nier3906", "projectName": "영산강물환경연구소 수질측정센터 증축 건축공사", "brnNorm": "4168304844"}, {"brn": "521-86-01984", "olbaroId": "nysofree25", "projectName": "영산강 하구둑 제2배수갑문 기전 정비작업 폐기물 처리", "brnNorm": "5218601984"}, {"brn": "413-83-00010", "olbaroId": "qhtjd2501", "projectName": "*보성군청(기후환경과)-2025년 생활폐기물(가연성) 위탁처리 용역(추가분)", "brnNorm": "4138300010"}, {"brn": "415-83-00016", "olbaroId": "rPrhrdnjfdka", "projectName": "계곡 월암 용배수로 정비공사 가연성폐기물 처리용역", "brnNorm": "4158300016"}, {"brn": "410-83-02606", "olbaroId": "rPtn2025", "projectName": "계수마을 공영주차장 부지 건물 철거 및 해체공사 가연성폐기물 처리용역", "brnNorm": "4108302606"}, {"brn": "611-86-02248", "olbaroId": "readmind-1", "projectName": "문성고등학교 실개조 건축공사", "brnNorm": "6118602248"}, {"brn": "410-82-17397", "olbaroId": "remod6-8", "projectName": "23년 노후 공공임대 리모델링공사 6권역 폐기물 처리용역 - 광주북구", "brnNorm": "4108217397"}, {"brn": "410-82-17397", "olbaroId": "remod6-9", "projectName": "23년 노후 공공임대 리모델링공사 6권역 폐기물 처리용역(가연성) - 광주광산구", "brnNorm": "4108217397"}, {"brn": "409-83-01591", "olbaroId": "rhdrh0224", "projectName": "담양공업고 하키장 인조잔디 교체공사", "brnNorm": "4098301591"}, {"brn": "413-83-00795", "olbaroId": "rhkdur2025", "projectName": "과역면 도천리 비위생매립지 정비사업 가연성폐기물(소각)처리 용역", "brnNorm": "4138300795"}, {"brn": "411-83-03103", "olbaroId": "rhksrhkd25-022", "projectName": "무안군청-2025년 회산백련지 상반기 임목 등 폐기물처리용역", "brnNorm": "4118303103"}, {"brn": "413-83-00795", "olbaroId": "rkdustjd2024-2", "projectName": "2024년 고흥군 생활폐기물(가연성폐기물) 위탁처리 용역(2차)", "brnNorm": "4138300795"}, {"brn": "413-83-00795", "olbaroId": "rkdustjd2025-2", "projectName": "2025년 고흥군 생활폐기물(가연성폐기물) 위탁처리 용역", "brnNorm": "4138300795"}, {"brn": "414-83-00032", "olbaroId": "rkdwls25-3", "projectName": "강진군청-2025년 방치폐기물 위탁 처리용역", "brnNorm": "4148300032"}, {"brn": "409-83-02514", "olbaroId": "rlatnwls1111", "projectName": "무등경기장 주변 주민편의시설 내진보강 및 리모델링공사 폐기물처리용역", "brnNorm": "4098302514"}, {"brn": "417-83-00031", "olbaroId": "rnjseo", "projectName": "광양항 3단계 투기장(1구역) 항만재개발사업 연결도로 장비엔진오일 교환 처리용역", "brnNorm": "4178300031"}, {"brn": "410-81-72414", "olbaroId": "sambaek-w02", "projectName": "전남농협포장재가공사업소 내 연료탱크 철거용역", "brnNorm": "4108172414"}, {"brn": "410-81-35781", "olbaroId": "sejin007060", "projectName": "(주)세진종합건설 함평경찰서 민원실동 건축공사", "brnNorm": "4108135781"}, {"brn": "313-86-02460", "olbaroId": "sh0246015", "projectName": "우치공원 유희시설(씽씽보트) 보수공사", "brnNorm": "3138602460"}, {"brn": "411-83-01162", "olbaroId": "shinan2024-97", "projectName": "지도초 그린스마트스쿨 본관동 개축 및 별관동 리모델링공사 가연성폐기물 처리용역", "brnNorm": "4118301162"}, {"brn": "307-81-27006", "olbaroId": "sjsj3920408", "projectName": "강진중 연립관사 외 1건 보수공사", "brnNorm": "3078127006"}, {"brn": "412-83-01898", "olbaroId": "skqlcvkzm2025", "projectName": "함평 엑스포공원 에듀테인먼트파크 조성사업 폐기물 처리 용역", "brnNorm": "4128301898"}, {"brn": "412-83-02811", "olbaroId": "skwnqkdcl2501", "projectName": "*나주시청(도시미화과)-관내 방치폐기물 위탁처리(산포,남평,봉황)", "brnNorm": "4128302811"}, {"brn": "408-81-32025", "olbaroId": "susung7", "projectName": "자은중 본관동 창호 교체공사", "brnNorm": "4088132025"}, {"brn": "134-87-17843", "olbaroId": "tesskorea24-1", "projectName": "전산실 항온항습용 노후 냉각탑 교체 폐기물처리", "brnNorm": "1348717843"}, {"brn": "410-83-00739", "olbaroId": "thdwjd5dlf", "projectName": "*광산구청(시민경제과)-송정5일시장 화재피해 장옥 철거 폐기물(합성수지) 용역", "brnNorm": "4108300739"}, {"brn": "417-83-00142", "olbaroId": "thqkdvh1", "projectName": "여수경찰서 주차동 소방포원액탱크 교체공사 중 지정폐기물 처리", "brnNorm": "4178300142"}, {"brn": "416-83-00187", "olbaroId": "tkdtkafl364", "projectName": "지봉로 완충녹지 지장물 철거 폐콘크리트 처리용역(해룡면 상삼리 364)", "brnNorm": "4168300187"}, {"brn": "409-81-58877", "olbaroId": "tpsehflvPdb", "projectName": "유한책임회사 센도리-사업장 내 폐유 운반처리", "brnNorm": "4098158877"}, {"brn": "416-83-00187", "olbaroId": "whfPehd72-55", "projectName": "지봉로 완충녹지 (파머스 앞) 건축물 폐콘크리트 처리 용역", "brnNorm": "4168300187"}, {"brn": "409-83-00651", "olbaroId": "wkdtjddnjftks", "projectName": "2025년 장성 월산마을 취약지역 생활여건개조사업 빈집 철거", "brnNorm": "4098300651"}, {"brn": "408-81-55450", "olbaroId": "wlgus202400561", "projectName": "금정면 아천리 18-1 폐기물처리용역", "brnNorm": "4088155450"}, {"brn": "205-82-06022", "olbaroId": "wlsdnjfxpsltm", "projectName": "진월테니스장 시설 개보수공사 소각폐기물 처리용역", "brnNorm": "2058206022"}, {"brn": "409-83-00520", "olbaroId": "wp202573", "projectName": "전남대학교 보조운동장 철거공사 폐기물처리용역(폐콘크리트)", "brnNorm": "4098300520"}, {"brn": "410-83-02606", "olbaroId": "wp25-20", "projectName": "기름유출로 인한 지정폐기물처리(25년)", "brnNorm": "4108302606"}, {"brn": "410-83-06112", "olbaroId": "yg2548", "projectName": "상하수도사업소 하수준설토 처리용역", "brnNorm": "4108306112"}, {"brn": "408-81-45535", "olbaroId": "ys20241210", "projectName": "서구청소년수련관외장재교체공사", "brnNorm": "4088145535"}];

    let rows = Array.isArray(EMBEDDED) ? EMBEDDED : [];
    let matchesCache = [];

    const $ = (id) => document.getElementById(id);
    const statusEl = $("status");
    const input = $("brnInput");
    const tbody = $("resultBody");
    const btnSearch = $("btnSearch");
    const btnExport = $("btnExport");
    const toast = $("toast");

    function normBRN(s) { return (s || "").replace(/\D/g, ""); }

    function renderRows(list) { 
      tbody.innerHTML = "";
      if (!list.length) {
        const tr = document.createElement("tr");
        const td = document.createElement("td");
        td.colSpan = 3;
        td.style.textAlign = "center";
        td.style.color = "#94a3b8";
        td.style.padding = "18px";
        td.textContent = "조회 결과가 여기에 표시됩니다.";
        tr.appendChild(td);
        tbody.appendChild(tr);
        return;
      }
      for (const r of list) {
        const tr = document.createElement("tr");
        const td1 = document.createElement("td"); td1.textContent = r.brn || ""; tr.appendChild(td1);
        const td2 = document.createElement("td"); td2.textContent = r.olbaroId || ""; td2.className="mono"; tr.appendChild(td2);
        const td3 = document.createElement("td"); td3.textContent = r.projectName || ""; tr.appendChild(td3);
        // Copy on click (올바로ID)
        td2.style.cursor = "pointer";
        td2.title = "클릭하여 ID 복사";
        td2.addEventListener("click", () => copyText(td2.textContent || ""));
        tbody.appendChild(tr);
      }
    }

    function copyText(text) {
      if (!text) return;
      navigator.clipboard?.writeText(text).then(() => showToast(`올바로ID가 복사되었습니다: ${text}`)).catch(() => {});
    }

    function showToast(msg) {
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(() => toast.classList.remove("show"), 1500);
    }

    function search() {
      const key = normBRN(input.value);
      if (!key) {
        statusEl.textContent = "사업자번호를 입력하세요.";
        matchesCache = [];
        renderRows(matchesCache);
        return;
      }
      matchesCache = rows.filter(r => normBRN(r.brn) === key);
      statusEl.textContent = matchesCache.length ? (matchesCache.length + "건이 조회되었습니다.") : "조회 결과가 없습니다.";
      renderRows(matchesCache);
    }

    btnSearch.addEventListener("click", search);
    input.addEventListener("keydown", (e) => { if (e.key === "Enter") search(); });

    // Export matches to CSV
    btnExport.addEventListener("click", () => {
      if (!matchesCache.length) { showToast("다운로드할 결과가 없습니다."); return; }
      const header = "사업자번호,올바로ID,공사명\n";
      const body = matchesCache.map(r => [r.brn, r.olbaroId, r.projectName].map(csvEscape).join(",")).join("\n");
      const blob = new Blob([header + body], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url; a.download = "lookup_results.csv";
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
      showToast("결과 CSV가 저장되었습니다.");
    });

    function csvEscape(v){
      const s = String(v ?? "");
      return /[",\n]/.test(s) ? '"' + s.replace(/"/g, '""') + '"' : s;
    }
  </script>
</body>
</html>
